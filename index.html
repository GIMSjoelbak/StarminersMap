<!DOCTYPE html>
<html lang ="en">
<head>
<meta http-equiv="Access-Control-Allow-Origin" content="*" />
  <base target="_top">
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
     integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
     crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
     integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
     crossorigin=""></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
  <style>
body {
      padding: 0;
      margin: 0;
    }
html, body, #map {
      height: 100%;
      width: 100%;
    }
/* Make the table cells have padding */
table {
  border-collapse: collapse;
  width: 100%;
}

td {
  padding: 3px;
font-size: 12px;
border: 1px solid black;
}

/* Set a fixed width for the table cells */
th, td {
  width: 20%;
  max-width: 250px;
}

/* Prevent text from wrapping */
td {
  white-space: nowrap;
  overflow: hidden;
}
td:last-child {
  width: 30%;
}
.leaflet-popup-content-wrapper {
  width: auto !important;
  max-width: 100% !important;
}
  </style>
  </head>
  <body>	  			
    <div id="map"</div>
	  <script src="coordinates.js"></script>
	  	  <script>
			  		  var polygon1 = L.polygon([
			  [1300,4855],
			  [1215,4890],
			  [1200,5530],
			  [1855,5410],
			  [2020,5425],
			  [2130,5190],
			  [2430,5180],
			  [2485,5145],
			  [2470,5085],
			  [2292,4810],
			  [2190,4705],
			  [2020,4695],
			  [1960,4805],
			  [1915,4840]
			  ], {
			   fillColor: '#ff0000', // set the fill color to red
  fillOpacity: 0.5, // set the fill opacity to 50%
  weight: 2, // set the border weight to 2 pixels
  color: '#000000' // set the border color to black
		  }).addTo(map);
		  
		  var polygon2 = L.polygon([
			  [1582,4502],
			  [1565,2965],
			  [1420,2865],
			  [1135,2838],
			  [900,3065],
			  [855,3280],
			  [1107,4394],
			  [1435,4550],
			  [1550,4538]
			  ]).addTo(map);
// Create empty tables for each polygon
var table1 = L.DomUtil.create('table', 'popup-table');
var table2 = L.DomUtil.create('table', 'popup-table');

// Create popups for each polygon
polygon1.bindPopup(table1);
polygon2.bindPopup(table2);

// Function to update table data from JSON
function updateTable(polygon, table) {
  fetch('stars.json')
    .then(response => response.json())
    .then(data => {
      // Filter data for location of the polygon
      var filteredData = data.filter(d => d.location === polygon.location);
      
      // Clear table rows
      table.innerHTML = '';
      
      // Create table header row
      var headerRow = table.insertRow();
      headerRow.insertCell().innerHTML = 'Location';
      headerRow.insertCell().innerHTML = 'World';
      headerRow.insertCell().innerHTML = 'Min Time';
      headerRow.insertCell().innerHTML = 'Max Time';
      headerRow.insertCell().innerHTML = 'Called Location';
      
      // Add data rows to table
      filteredData.forEach(d => {
        var dataRow = table.insertRow();
        dataRow.insertCell().innerHTML = d.location;
        dataRow.insertCell().innerHTML = d.world;
        dataRow.insertCell().innerHTML = new Date(d.minTime * 1000).toLocaleString();
        dataRow.insertCell().innerHTML = new Date(d.maxTime * 1000).toLocaleString();
        dataRow.insertCell().innerHTML = d.calledLocation;
      });
    })
    .catch(error => console.error('Error:', error));
}

// Update table data for each polygon when popup is opened
polygon1.on('popupopen', function() {
  updateTable(polygon1, table1);
});

polygon2.on('popupopen', function() {
  updateTable(polygon2, table2);
});

// Update table data for each polygon every 60 seconds
setInterval(function() {
  updateTable(polygon1, table1);
  updateTable(polygon2, table2);
}, 60000);
	  </script>
  </body>
 </html>
  
      
  
